{% extends 'base.html.twig' %}

{% block title %}Propriétés entre {{ minPrice|number_format(0, ',', ' ') }} € et {{ maxPrice|number_format(0, ',', ' ') }} €{% endblock %}

{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{% block body %}
<div class="container mx-auto p-4">
    <h2 class="text-2xl font-bold text-primary mb-4">Propriétés entre {{ minPrice|number_format(0, ',', ' ') }} € et {{ maxPrice|number_format(0, ',', ' ') }} €</h2>
    <div class="overflow-x-auto">
        <table class="min-w-full bg-white">
            <thead>
                <tr>
                    <th class="px-4 py-2">ID</th>
                    <th class="px-4 py-2">Photo Principale</th>
                    <th class="px-4 py-2">Titre</th>
                    <th class="px-4 py-2">Type</th>
                    <th class="px-4 py-2">Prix</th>
                    <th class="px-4 py-2">Surface</th>
                    <th class="px-4 py-2">Ville</th>
                    <th class="px-4 py-2">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for propriete in proprietes %}
                    <tr class="bg-gray-100">
                        <td class="border px-4 py-2">{{ propriete.id }}</td>
                        <td class="border px-4 py-2">
                            {% set photoPrincipale = propriete.photo|filter(photo => photo.principale)|first %}
                            {% if photoPrincipale %}
                                <img src="{{ asset(photoPrincipale.filename) }}" alt="Photo Principale" class="max-w-xs max-h-xs">
                            {% else %}
                                <span>Pas de photo</span>
                            {% endif %}
                        </td>
                        <td class="border px-4 py-2">{{ propriete.titre }}</td>
                        <td class="border px-4 py-2">{{ propriete.type }}</td>
                        <td class="border px-4 py-2">{{ propriete.prix|number_format(0, ',', ' ') }} €</td>
                        <td class="border px-4 py-2">{{ propriete.surface }} m²</td>
                        <td class="border px-4 py-2">{{ propriete.ville }}</td>
                        <td class="border px-4 py-2">
                            <a href="{{ path('proprietedetail', {'id': propriete.id}) }}" class="btn btn-primary text-primary bg-secondary px-4 py-2 rounded">Voir détails</a>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="8" class="border px-4 py-2 text-center">Aucune propriété trouvée dans cette plage de prix.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

